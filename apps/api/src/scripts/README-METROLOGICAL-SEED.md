# סקריפט Seed למידע מטרולוגי מקיף

סקריפט זה מכניס למערכת את כל המידע המטרולוגי הרלוונטי לכיולי משקלות ומאזניים.

## מה הסקריפט עושה?

### 1. מודלי משקלות נפוצים
הסקריפט מכניס למערכת עשרות מודלי משקלות מיצרנים מובילים:
- **Mettler Toledo** - IND780, XP/XS
- **Sartorius** - Entris II, Quintix
- **Ohaus** - Adventurer
- **A&D** - GF
- **Kern** - PCB
- **Tanita** - KD

כל מודל כולל:
- יצרן ודגם
- קיבולת מקסימלית
- יחידת מדידה (g/kg/mg)
- חלוקה אמיתית (d) וחלוקת כיול (e)
- דרגת דיוק (I, II, III, IIII)

### 2. פרופילים מטרולוגיים
לכל שילוב ייחודי של קיבולת, יחידה, חלוקות ודרגת דיוק, נוצר פרופיל מטרולוגי עם:
- מפרטים טכניים מלאים
- מצב סובלנות (HUB_REFERENCE)
- מפתח HUB אוטומטי

### 3. טבלאות סובלנות (MPE)
לכל פרופיל נוצרות טבלאות סובלנות לפי תקן **OIML R76** עבור כל סוגי הבדיקות:

#### בדיקת דיוק (ACCURACY)
- נקודות בדיקה סטנדרטיות לפי תקן OIML R76
- חישוב MPE לפי דרגת הדיוק:
  - **Class I**: ±0.5e (עד 50,000e), ±1.0e (מעל 50,000e)
  - **Class II**: ±1.0e (עד 5,000e), ±1.5e (מעל 5,000e)
  - **Class III**: ±1.5e (עד 500e), ±2.0e (מעל 500e)
  - **Class IIII**: ±2.5e (עד 50e), ±3.0e (מעל 50e)

#### בדיקת אקסצנטריות (ECCENTRICITY)
- בדיקה ב-1/3 מהקיבולת המקסימלית
- סובלנות לפי MPE של העומס

#### בדיקת חזרתיות (REPEATABILITY)
- בדיקה ב-50% מהקיבולת המקסימלית
- סובלנות לפי MPE של העומס

#### בדיקת רגישות (SENSITIVITY)
- בדיקה ב-100% מהקיבולת המקסימלית
- סובלנות לפי MPE של העומס

#### בדיקת זמן (TIME)
- בדיקה ב-50% מהקיבולת המקסימלית
- סובלנות: e (Class I) או 2e (אחרים)

#### בדיקת טרה (TARE)
- בדיקה ב-100% מהקיבולת המקסימלית
- סובלנות: 0.5e (Class I) או e (אחרים)

### 4. נקודות בדיקה
לכל סוג בדיקה נוצרות נקודות בדיקה סטנדרטיות:
- נקודות לפי תקן OIML R76
- עיגול לערכי e הקרובים
- נקודות אחוזים מהקיבולת (20%, 50%, 75%, 100%)

### 5. קישור מודלים לפרופילים
הסקריפט מקשר אוטומטית כל מודל משקלת לפרופיל המטרולוגי המתאים לו.

## איך להריץ?

```bash
cd apps/api
npm run seed:metrological
```

## תמיכה ב-OIML Engine Mode

הסקריפט כולל גם פונקציה `createOIMLProfile` שיוצרת פרופילים עם מצב OIML_ENGINE, כולל:
- multipliers נכונים לפי תקן OIML R76
- thresholds דינמיים לפי דרגת הדיוק
- נקודות בדיקה אוטומטיות

## הערות חשובות

1. **הסקריפט לא מוחק נתונים קיימים** - הוא רק מוסיף או מעדכן פרופילים קיימים
2. **טבלאות סובלנות** - אם יש טבלאות קיימות, הן נמחקות ונוצרות מחדש
3. **נקודות בדיקה** - נוצרות אוטומטית לפי נקודות הסובלנות
4. **קישור מודלים** - רק מודלים ללא פרופיל מקושרים אוטומטית

## תקנים ומקורות

המידע מבוסס על:
- **OIML R76** - תקן בינלאומי למשקלות לא אוטומטיות
- **ISO 9001** - מערכות ניהול איכות
- **תקנות ישראליות** - תקנות כיול משקלות

## דוגמאות למודלים שהוכנסו

- משקלות מעבדה מדויקות (Class I): 0.22g עד 220g
- משקלות מטבח (Class II): 220g עד 30kg
- משקלות תעשייתיות (Class III): 150kg עד 10,000kg
- משקלות מסחריות (Class IIII): 15kg עד 30,000kg

## תמיכה

אם יש בעיות או שאלות, בדוק:
1. שהמסד נתונים פועל
2. שהטבלאות נוצרו (Prisma migrations)
3. את הלוגים של הסקריפט

